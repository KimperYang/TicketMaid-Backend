# 踩坑笔记

+ 坑点1：

  > 前端请求跨域问题

  解决方案：

  1. 使用Nginx反向代理，将前端请求直接代理到后端ip
  2. 在后端代码中给方法加上注解`@CrossOrigin`允许跨域

+ 坑点2：

  > 后端部署后需要用Nginx反代，反代导致请求头信息丢失

  解决方案：

  在Nginx配置文件中写上自定义请求头的传递，在这里就是`access_token`和`refresh_token`

  ```nginx
  server {
          listen       8123;
          listen       [::]:8123;
          root /usr/share/nginx/html/ticketmaid;
          server_name  _;
  
          underscores_in_headers on;
          charset utf-8;
  
          location /api {
                  proxy_set_header Host localhost;
                  proxy_set_header X-Forwarded-Proto $scheme;
                  proxy_set_header X-Real-IP $remote_addr;
                  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                  proxy_set_header access_token ${http_access_token};
                  proxy_set_header refresh_token ${http_refresh_token};
                  proxy_pass http://srv2;
          }
  
          location / {
  
          }
  
          location = /favicon.ico { access_log off; log_not_found off; }
      }
  
  ```

+ 坑点3：

  > 数据库中表名不能为`order`

  解决方案：因为`order`是mysql的保留字，因此不能使用。将表改名为`orders`解决问题。